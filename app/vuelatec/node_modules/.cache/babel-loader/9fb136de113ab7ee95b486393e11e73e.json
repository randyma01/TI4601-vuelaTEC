{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\gusfc\\\\Documents\\\\GitHub\\\\TI4601-vuelaTEC\\\\app\\\\vuelatec\\\\src\\\\components\\\\Passenger\\\\Report\\\\Passenger-flights\\\\index.js\";\nimport React from 'react';\nimport { Col, Container, Form, Table } from 'react-bootstrap';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport IconButton from '@material-ui/core/IconButton';\nimport Refresh from '@material-ui/icons/Refresh';\n\nclass Report extends React.Component {\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n\n    this.componentDidMount = async () => {\n      this._isMounted = true;\n      await fetch(\"http://localhost:3000/passenger/myTickets/\".concat(this.state.dataUser._id), {\n        method: \"GET\"\n      }).then(response => response.json()).then(responseJson => {\n        if (responseJson !== '' && this._isMounted) {\n          this.setState({\n            tickets: responseJson\n          });\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n      await fetch('http://localhost:3000/passengers/allFlights/', {\n        method: \"GET\"\n      }).then(response => response.json()).then(responseJson => {\n        if (responseJson !== '' && this._isMounted) {\n          this.setState({\n            allFlights: responseJson\n          });\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n\n      if (this._isMounted) {\n        this.state.allFlights.forEach(flight => {\n          this.state.tickets.forEach(ticket => {\n            if (flight._id === ticket.flight_id && !this.state.flights.includes(flight)) {\n              this.setState({\n                flights: [...this.state.flights, flight],\n                flightsTemp: [...this.state.flightsTemp, flight]\n              });\n            }\n          });\n        });\n      }\n    };\n\n    this._onClickRefresTickets = async () => {\n      this.setState({\n        flights: this.state.flightsTemp,\n        stateFlight: '',\n        startDateFlight: '',\n        endDateFlight: ''\n      });\n    };\n\n    this.state = {\n      allFlights: [],\n      stateFlight: '',\n      startDateFlight: '',\n      endDateFlight: '',\n      filtersDate: [],\n      filtersState: [],\n      tickets: [],\n      flights: [],\n      flightsTemp: [],\n      dataUser: props.dataUser\n    };\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  _handleChangeEndDate(event) {\n    let endDateFilter = event.target.value;\n    let filterFlights = this.state.stateFlight === '' ? this.state.flightsTemp.filter(item => item.takeOff >= this.state.startDateFlight && item.landing <= endDateFilter) : this.state.filtersState.filter(item => item.takeOff >= this.state.startDateFlight && item.landing <= endDateFilter);\n    this.setState({\n      endDateFlight: endDateFilter,\n      flights: filterFlights,\n      filtersDate: filterFlights\n    });\n  }\n\n  _handleChangeSelectState(event) {\n    let stateFilter = event.target.value;\n    let filterFlights = this.state.endDateFlight === '' ? this.state.flightsTemp.filter(item => item.state === stateFilter) : this.state.filtersDate.filter(item => item.state === stateFilter);\n\n    if (stateFilter === 'Todos') {\n      this.setState({\n        stateFlight: stateFilter,\n        flights: this.state.flightsTemp,\n        filtersState: filterFlights\n      });\n    } else {\n      this.setState({\n        stateFlight: stateFilter,\n        flights: filterFlights,\n        filtersState: filterFlights\n      });\n    }\n  }\n\n  _handleChangeStartDate(event) {\n    this.setState({\n      startDateFlight: event.target.value\n    });\n  }\n\n  render() {\n    return React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        margin: '5%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      align: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, \"Consultar mis vuelos\")), React.createElement(Form, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(Form.Row, {\n      style: {\n        marginTop: '4%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(Form.Group, {\n      as: Col,\n      controlId: \"ControlSelectState\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, \"Estado\"), React.createElement(Form.Control, {\n      as: \"select\",\n      defaultValue: 'DEFAULT',\n      onChange: this._handleChangeSelectState.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: 'DEFAULT',\n      disabled: true,\n      hidden: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"Seleccionar un estado de vuelo\"), React.createElement(\"option\", {\n      value: 'Todos',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"Todos\"), React.createElement(\"option\", {\n      value: 'A tiempo',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, \"A Tiempo\"), React.createElement(\"option\", {\n      value: 'Retrasado',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, \"Retrasado\"), React.createElement(\"option\", {\n      value: 'Cancelado',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, \"Cancelado\"))), React.createElement(Form.Group, {\n      as: Col,\n      controlId: \"ControlInputStartDate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \"Desde\"), React.createElement(Form.Control, {\n      type: \"date\",\n      placeholder: \"dd/mm/yyyy\",\n      onChange: this._handleChangeStartDate.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    })), React.createElement(Form.Group, {\n      as: Col,\n      controlId: \"ControlInputEndDate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \"Hasta\"), React.createElement(Form.Control, {\n      type: \"date\",\n      placeholder: \"dd/mm/yyyy\",\n      onChange: this._handleChangeEndDate.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      style: {\n        marginTop: '5%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, React.createElement(IconButton, {\n      \"aria-label\": \"refresh\",\n      onClick: this._onClickRefresTickets,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, React.createElement(Refresh, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    })), React.createElement(Table, {\n      striped: true,\n      bordered: true,\n      hover: true,\n      responsive: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, \"Identificador\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"Nombre\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, \"Origen\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, \"Destino\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"Itinerario\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, \"Precio\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"Estado\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, \"Capacidad permitida\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, \"C\\xF3digo de Aerolinea\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, \"Restricciones\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, \"Servicios\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, \"Ticket\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, this.state.flights.map((flight, indexF) => React.createElement(\"tr\", {\n      key: indexF,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, flight._id), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, flight.name), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, flight.origin), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, flight.destination), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, \"Salida: \", flight.takeOff, \" [\", flight.departure, \"] - Llegada: \", flight.landing, \" [\", flight.arrives, \"]\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, \"$ \", flight.price), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, flight.state), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, flight.capacityPlane), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, flight.airline_id), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, JSON.stringify(flight.restrictions)), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, JSON.stringify(flight.services)), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, this.state.tickets.map((ticket, index) => flight._id === ticket.flight_id ? JSON.stringify(ticket) : null))))))));\n  }\n\n}\n\nexport default Report;","map":{"version":3,"sources":["C:/Users/gusfc/Documents/GitHub/TI4601-vuelaTEC/app/vuelatec/src/components/Passenger/Report/Passenger-flights/index.js"],"names":["React","Col","Container","Form","Table","IconButton","Refresh","Report","Component","constructor","props","_isMounted","componentDidMount","fetch","state","dataUser","_id","method","then","response","json","responseJson","setState","tickets","catch","error","console","allFlights","forEach","flight","ticket","flight_id","flights","includes","flightsTemp","_onClickRefresTickets","stateFlight","startDateFlight","endDateFlight","filtersDate","filtersState","componentWillUnmount","_handleChangeEndDate","event","endDateFilter","target","value","filterFlights","filter","item","takeOff","landing","_handleChangeSelectState","stateFilter","_handleChangeStartDate","render","margin","marginTop","bind","map","indexF","name","origin","destination","departure","arrives","price","capacityPlane","airline_id","JSON","stringify","restrictions","services","index"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Col, Container, Form, Table } from 'react-bootstrap';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Refresh from '@material-ui/icons/Refresh';\r\n\r\nclass Report extends React.Component {\r\n  _isMounted = false;\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      allFlights: [],\r\n      stateFlight: '',\r\n      startDateFlight: '',\r\n      endDateFlight: '',\r\n      filtersDate: [],\r\n      filtersState: [],\r\n      tickets: [],\r\n      flights: [],\r\n      flightsTemp: [],\r\n      dataUser: props.dataUser\r\n    };\r\n  }\r\n\r\n  componentDidMount = async () => {\r\n    this._isMounted = true;\r\n    await fetch(`http://localhost:3000/passenger/myTickets/${this.state.dataUser._id}`,\r\n      {\r\n        method: \"GET\"\r\n      })\r\n      .then(response => response.json())\r\n      .then(responseJson => {\r\n        if (responseJson !== '' && this._isMounted) {\r\n          this.setState({\r\n            tickets: responseJson\r\n          });\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error(error);\r\n      });\r\n    await fetch('http://localhost:3000/passengers/allFlights/',\r\n      {\r\n        method: \"GET\"\r\n      })\r\n      .then(response => response.json())\r\n      .then(responseJson => {\r\n        if (responseJson !== '' && this._isMounted) {\r\n          this.setState({\r\n            allFlights: responseJson\r\n          });\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error(error);\r\n      });\r\n    if (this._isMounted) {\r\n      this.state.allFlights.forEach(flight => {\r\n        this.state.tickets.forEach(ticket => {\r\n          if (flight._id === ticket.flight_id && !this.state.flights.includes(flight)) {\r\n            this.setState({\r\n              flights: [...this.state.flights, flight],\r\n              flightsTemp: [...this.state.flightsTemp, flight],\r\n            })\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n  }\r\n\r\n  _handleChangeEndDate(event) {\r\n    let endDateFilter = event.target.value;\r\n    let filterFlights = this.state.stateFlight === '' ? this.state.flightsTemp.filter(item => item.takeOff >= this.state.startDateFlight && item.landing <= endDateFilter) : this.state.filtersState.filter(item => item.takeOff >= this.state.startDateFlight && item.landing <= endDateFilter);\r\n    this.setState({\r\n      endDateFlight: endDateFilter,\r\n      flights: filterFlights,\r\n      filtersDate: filterFlights\r\n    })\r\n  }\r\n\r\n  _handleChangeSelectState(event) {\r\n    let stateFilter = event.target.value;\r\n    let filterFlights = this.state.endDateFlight === '' ? this.state.flightsTemp.filter(item => item.state === stateFilter) : this.state.filtersDate.filter(item => item.state === stateFilter);\r\n\r\n    if (stateFilter === 'Todos') {\r\n      this.setState({\r\n        stateFlight: stateFilter,\r\n        flights: this.state.flightsTemp,\r\n        filtersState: filterFlights\r\n      })\r\n    } else {\r\n      this.setState({\r\n        stateFlight: stateFilter,\r\n        flights: filterFlights,\r\n        filtersState: filterFlights\r\n      })\r\n    }\r\n  }\r\n\r\n  _handleChangeStartDate(event) {\r\n    this.setState({ startDateFlight: event.target.value });\r\n  }\r\n\r\n  _onClickRefresTickets = async () => {\r\n    this.setState({\r\n      flights: this.state.flightsTemp,\r\n      stateFlight: '', startDateFlight: '', endDateFlight: ''\r\n    })\r\n  }\r\n\r\n\r\n  render() {\r\n    return (\r\n      <Container>\r\n        <div style={{ margin: '5%' }}>\r\n          <h5 align='center'>Consultar mis vuelos</h5>\r\n        </div>\r\n        <Form>\r\n          <Form.Row style={{ marginTop: '4%' }}>\r\n            <Form.Group as={Col} controlId=\"ControlSelectState\" >\r\n              <Form.Label>Estado</Form.Label>\r\n              <Form.Control as=\"select\" defaultValue={'DEFAULT'} onChange={this._handleChangeSelectState.bind(this)}>\r\n                <option value={'DEFAULT'} disabled hidden>Seleccionar un estado de vuelo</option>\r\n                <option value={'Todos'}>Todos</option>\r\n                <option value={'A tiempo'}>A Tiempo</option>\r\n                <option value={'Retrasado'}>Retrasado</option>\r\n                <option value={'Cancelado'}>Cancelado</option>\r\n              </Form.Control>\r\n            </Form.Group>\r\n            <Form.Group as={Col} controlId=\"ControlInputStartDate\">\r\n              <Form.Label>Desde</Form.Label>\r\n              <Form.Control type=\"date\" placeholder=\"dd/mm/yyyy\" onChange={this._handleChangeStartDate.bind(this)} />\r\n            </Form.Group>\r\n            <Form.Group as={Col} controlId=\"ControlInputEndDate\">\r\n              <Form.Label>Hasta</Form.Label>\r\n              <Form.Control type=\"date\" placeholder=\"dd/mm/yyyy\" onChange={this._handleChangeEndDate.bind(this)} />\r\n            </Form.Group>\r\n          </Form.Row>\r\n        </Form>\r\n        <div style={{ marginTop: '5%' }}>\r\n          <IconButton aria-label=\"refresh\" onClick={this._onClickRefresTickets}>\r\n            <Refresh />\r\n          </IconButton>\r\n          <Table striped bordered hover responsive >\r\n            <thead>\r\n              <tr>\r\n                <th>Identificador</th>\r\n                <th>Nombre</th>\r\n                <th>Origen</th>\r\n                <th>Destino</th>\r\n                <th>Itinerario</th>\r\n                <th>Precio</th>\r\n                <th>Estado</th>\r\n                <th>Capacidad permitida</th>\r\n                <th>CÃ³digo de Aerolinea</th>\r\n                <th>Restricciones</th>\r\n                <th>Servicios</th>\r\n                <th>Ticket</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.state.flights.map((flight, indexF) => (\r\n                <tr key={indexF}>\r\n                  <td>{flight._id}</td>\r\n                  <td>{flight.name}</td>\r\n                  <td>{flight.origin}</td>\r\n                  <td>{flight.destination}</td>\r\n                  <td>Salida: {flight.takeOff} [{flight.departure}] - Llegada: {flight.landing} [{flight.arrives}]</td>\r\n                  <td>$ {flight.price}</td>\r\n                  <td>{flight.state}</td>\r\n                  <td>{flight.capacityPlane}</td>\r\n                  <td>{flight.airline_id}</td>\r\n                  <td>{JSON.stringify(flight.restrictions)}</td>\r\n                  <td>{JSON.stringify(flight.services)}</td>\r\n                  <td>\r\n                    {this.state.tickets.map((ticket, index) => (\r\n                      flight._id === ticket.flight_id ? (\r\n                        JSON.stringify(ticket)\r\n                      ) : null\r\n                    ))}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </Table>\r\n        </div>\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default Report;\r\n"]},"metadata":{},"sourceType":"module"}