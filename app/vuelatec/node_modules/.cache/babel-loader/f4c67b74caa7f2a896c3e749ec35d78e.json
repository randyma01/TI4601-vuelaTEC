{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\gusfc\\\\Documents\\\\GitHub\\\\TI4601-vuelaTEC\\\\app\\\\vuelatec\\\\src\\\\components\\\\Administrator\\\\Report\\\\Amount-ticket\\\\index.js\";\nimport React from 'react';\nimport { Container, Col, Form, Table } from 'react-bootstrap';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport FindReplaceIcon from '@material-ui/icons/FindReplace';\nimport IconButton from '@material-ui/core/IconButton';\nimport Refresh from '@material-ui/icons/Refresh';\n\nclass Report extends React.Component {\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n\n    this.componentDidMount = () => {\n      this._isMounted = true;\n      fetch('http://localhost:3000/employee/allTickets/', {\n        method: \"GET\"\n      }).then(response => response.json()).then(responseJson => {\n        if (responseJson !== '' && this._isMounted) {\n          this.setState({\n            allTicketsTemp: responseJson\n          });\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n      fetch('http://localhost:3000/admin/findAllFlights/', {\n        method: \"GET\"\n      }).then(response => response.json()).then(responseJson => {\n        if (responseJson !== '' && this._isMounted) {\n          this.setState({\n            allFlights: responseJson,\n            flightsTemp: responseJson\n          });\n          this.state.allTicketsTemp.forEach(async ticket => {\n            await fetch(\"http://localhost:3000/employee/passengerInfo/\".concat(ticket.passenger_id), {\n              method: \"GET\"\n            }).then(response => response.json()).then(passenger => {\n              if (passenger !== '') {\n                ticket[\"passenger\"] = passenger[0];\n                this.setState({\n                  allTickets: [...this.state.allTickets, ticket]\n                });\n              }\n            }).catch(error => {\n              console.error(error);\n            });\n          });\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n\n    this._handleChangePassengerFilter = () => {\n      let filterTickets = this.state.allTickets.filter(ticket => parseInt(ticket.passenger[\"_id\"]) === parseInt(this.state.passengerId));\n      let filterFlights = [];\n      console.log(filterTickets);\n      this.state.allFlights.forEach(flight => {\n        filterTickets.forEach(ticket => {\n          if (flight._id === ticket.flight_id && !filterFlights.includes(flight)) {\n            filterFlights.push(flight);\n          }\n        });\n      });\n      this.setState({\n        allFlights: filterFlights\n      });\n    };\n\n    this._onClickRefresTickets = async () => {\n      this.setState({\n        allFlights: this.state.flightsTemp,\n        stateFlight: '',\n        startDateFlight: '',\n        endDateFlight: ''\n      });\n    };\n\n    this._sumAmountTicket = flightId => {\n      let totalAmountTicket = 0;\n      this.state.allTickets.forEach(ticket => {\n        if (flightId === ticket.flight_id) {\n          totalAmountTicket += ticket.amount;\n        }\n      });\n      return React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, totalAmountTicket);\n    };\n\n    this.state = {\n      allFlights: [],\n      allTickets: [],\n      allTicketsTemp: [],\n      endDateFlight: '',\n      filtersDate: [],\n      filtersState: [],\n      flights: [],\n      flightsTemp: [],\n      passengerForTicker: [],\n      passengerId: '',\n      passengerTemp: [],\n      startDateFlight: '',\n      stateFlight: ''\n    };\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  _handleChangeEndDate(event) {\n    let endDateFilter = event.target.value;\n    let filterFlights = this.state.stateFlight === '' || this.state.endDateFlight ? this.state.flightsTemp.filter(item => item.takeOff >= this.state.startDateFlight && item.landing <= endDateFilter) : this.state.filtersState.filter(item => item.takeOff >= this.state.startDateFlight && item.landing <= endDateFilter);\n    this.setState({\n      endDateFlight: endDateFilter,\n      allFlights: filterFlights,\n      filtersDate: filterFlights\n    });\n  }\n\n  _handleChangePassenger(event) {\n    this.setState({\n      passengerId: event.target.value\n    });\n  }\n\n  _handleChangeSelectState(event) {\n    let stateFilter = event.target.value;\n    let filterFlights = this.state.endDateFlight === '' ? this.state.flightsTemp.filter(item => item.state === stateFilter) : this.state.filtersDate.filter(item => item.state === stateFilter);\n    this.setState({\n      stateFlight: stateFilter,\n      allFlights: filterFlights,\n      filtersState: filterFlights\n    });\n  }\n\n  _handleChangeStartDate(event) {\n    this.setState({\n      startDateFlight: event.target.value\n    });\n  }\n\n  render() {\n    return React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        marginTop: '2%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(Form, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(Form.Row, {\n      style: {\n        marginTop: '4%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(Form.Group, {\n      as: Col,\n      controlId: \"ControlSelectOrigin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, \"Identificaci\\xF3n\"), React.createElement(IconButton, {\n      \"aria-label\": \"searchName\",\n      onClick: this._handleChangePassengerFilter,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, React.createElement(FindReplaceIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    })), React.createElement(Form.Control, {\n      type: \"string\",\n      placeholder: \"Identidicaci\\xF3n de pasajero\",\n      onChange: this._handleChangePassenger.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    })), React.createElement(Form.Group, {\n      as: Col,\n      controlId: \"ControlSelectState\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, \"Estado\"), React.createElement(Form.Control, {\n      as: \"select\",\n      defaultValue: 'DEFAULT',\n      onChange: this._handleChangeSelectState.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: 'DEFAULT',\n      disabled: true,\n      hidden: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, \"Seleccionar un estado de vuelo\"), React.createElement(\"option\", {\n      value: 'A tiempo',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, \"A Tiempo\"), React.createElement(\"option\", {\n      value: 'Retrasado',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, \"Retrasado\"), React.createElement(\"option\", {\n      value: 'Cancelado',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, \"Cancelado\"))), React.createElement(Form.Group, {\n      as: Col,\n      controlId: \"ControlInputStartDate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Desde\"), React.createElement(Form.Control, {\n      type: \"date\",\n      placeholder: \"dd/mm/yyyy\",\n      onChange: this._handleChangeStartDate.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    })), React.createElement(Form.Group, {\n      as: Col,\n      controlId: \"ControlInputEndDate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, \"Hasta\"), React.createElement(Form.Control, {\n      type: \"date\",\n      placeholder: \"dd/mm/yyyy\",\n      onChange: this._handleChangeEndDate.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }))))), React.createElement(\"div\", {\n      style: {\n        marginTop: '5%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(IconButton, {\n      \"aria-label\": \"refresh\",\n      onClick: this._onClickRefresTickets,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(Refresh, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    })), React.createElement(Table, {\n      striped: true,\n      bordered: true,\n      hover: true,\n      responsive: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, \"Cantidad Operaciones\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, \"Identificador Vuelo\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, \"Nombre\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"Origen\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, \"Destino\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, \"Estado\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, \"C\\xF3digo de Aerolinea\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, \"Boletos\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, this.state.allFlights.map((flight, indexF) => React.createElement(\"tr\", {\n      key: indexF,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, this._sumAmountTicket(flight._id)), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, flight._id), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, flight.name), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, flight.origin), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, flight.destination), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, flight.state), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, flight.airline_id), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, this.state.allTickets.map((ticket, index) => flight._id === ticket.flight_id ? React.createElement(\"p\", {\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, \"C\\xF3digo: \", ticket._id, \" | Pasajero: \", ticket.passenger[\"firstName\"], \" - \", ticket.passenger[\"_id\"], \"  | Cantidad: \", ticket.amount, \".\") : null))))))));\n  }\n\n}\n\nexport default Report;","map":{"version":3,"sources":["C:/Users/gusfc/Documents/GitHub/TI4601-vuelaTEC/app/vuelatec/src/components/Administrator/Report/Amount-ticket/index.js"],"names":["React","Container","Col","Form","Table","FindReplaceIcon","IconButton","Refresh","Report","Component","constructor","props","_isMounted","componentDidMount","fetch","method","then","response","json","responseJson","setState","allTicketsTemp","catch","error","console","allFlights","flightsTemp","state","forEach","ticket","passenger_id","passenger","allTickets","_handleChangePassengerFilter","filterTickets","filter","parseInt","passengerId","filterFlights","log","flight","_id","flight_id","includes","push","_onClickRefresTickets","stateFlight","startDateFlight","endDateFlight","_sumAmountTicket","flightId","totalAmountTicket","amount","filtersDate","filtersState","flights","passengerForTicker","passengerTemp","componentWillUnmount","_handleChangeEndDate","event","endDateFilter","target","value","item","takeOff","landing","_handleChangePassenger","_handleChangeSelectState","stateFilter","_handleChangeStartDate","render","marginTop","bind","map","indexF","name","origin","destination","airline_id","index"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Container, Col, Form, Table } from 'react-bootstrap';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport FindReplaceIcon from '@material-ui/icons/FindReplace';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Refresh from '@material-ui/icons/Refresh';\r\n\r\nclass Report extends React.Component {\r\n  _isMounted = false;\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      allFlights: [],\r\n      allTickets: [],\r\n      allTicketsTemp: [],\r\n      endDateFlight: '',\r\n      filtersDate: [],\r\n      filtersState: [],\r\n      flights: [],\r\n      flightsTemp: [],\r\n      passengerForTicker: [],\r\n      passengerId: '',\r\n      passengerTemp: [],\r\n      startDateFlight: '',\r\n      stateFlight: ''\r\n    };\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    this._isMounted = true;\r\n    fetch('http://localhost:3000/employee/allTickets/',\r\n      {\r\n        method: \"GET\"\r\n      })\r\n      .then(response => response.json())\r\n      .then(responseJson => {\r\n        if (responseJson !== '' && this._isMounted) {\r\n          this.setState({\r\n            allTicketsTemp: responseJson\r\n          });\r\n\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error(error);\r\n      });\r\n    fetch('http://localhost:3000/admin/findAllFlights/',\r\n      {\r\n        method: \"GET\"\r\n      })\r\n      .then(response => response.json())\r\n      .then(responseJson => {\r\n        if (responseJson !== '' && this._isMounted) {\r\n          this.setState({\r\n            allFlights: responseJson,\r\n            flightsTemp: responseJson\r\n          });\r\n          this.state.allTicketsTemp.forEach(async ticket => {\r\n            await fetch(`http://localhost:3000/employee/passengerInfo/${ticket.passenger_id}`,\r\n              {\r\n                method: \"GET\"\r\n              })\r\n              .then(response => response.json())\r\n              .then(passenger => {\r\n                if (passenger !== '') {\r\n                  ticket[\"passenger\"] = passenger[0];\r\n                  this.setState({\r\n                    allTickets: [...this.state.allTickets, ticket]\r\n                  })\r\n                }\r\n              })\r\n              .catch(error => {\r\n                console.error(error);\r\n              });\r\n          });\r\n\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error(error);\r\n      });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n  }\r\n\r\n  _handleChangeEndDate(event) {\r\n    let endDateFilter = event.target.value;\r\n    let filterFlights = this.state.stateFlight === '' || this.state.endDateFlight\r\n      ?\r\n      this.state.flightsTemp.filter(item => item.takeOff >= this.state.startDateFlight && item.landing <= endDateFilter)\r\n      :\r\n      this.state.filtersState.filter(item => item.takeOff >= this.state.startDateFlight && item.landing <= endDateFilter);\r\n\r\n    this.setState({\r\n      endDateFlight: endDateFilter,\r\n      allFlights: filterFlights,\r\n      filtersDate: filterFlights\r\n    })\r\n  }\r\n\r\n  _handleChangePassenger(event) {\r\n    this.setState({ passengerId: event.target.value });\r\n\r\n  }\r\n\r\n  _handleChangePassengerFilter = () => {\r\n    let filterTickets = this.state.allTickets.filter(ticket => parseInt(ticket.passenger[\"_id\"]) === parseInt(this.state.passengerId));\r\n    let filterFlights = [];\r\n    console.log(filterTickets);\r\n    this.state.allFlights.forEach(flight => {\r\n      filterTickets.forEach(ticket => {\r\n        if (flight._id === ticket.flight_id && !filterFlights.includes(flight)) {\r\n          filterFlights.push(flight)\r\n        }\r\n      });\r\n    });\r\n    this.setState({\r\n      allFlights: filterFlights\r\n    })\r\n\r\n  }\r\n\r\n  _handleChangeSelectState(event) {\r\n    let stateFilter = event.target.value;\r\n    let filterFlights = this.state.endDateFlight === '' ? this.state.flightsTemp.filter(item => item.state === stateFilter) : this.state.filtersDate.filter(item => item.state === stateFilter);\r\n    this.setState({\r\n      stateFlight: stateFilter,\r\n      allFlights: filterFlights,\r\n      filtersState: filterFlights\r\n    })\r\n  }\r\n\r\n  _handleChangeStartDate(event) {\r\n    this.setState({ startDateFlight: event.target.value });\r\n  }\r\n\r\n  _onClickRefresTickets = async () => {\r\n    this.setState({\r\n      allFlights: this.state.flightsTemp,\r\n      stateFlight: '', startDateFlight: '', endDateFlight: '',\r\n    })\r\n  }\r\n\r\n  _sumAmountTicket = (flightId) => {\r\n    let totalAmountTicket = 0\r\n    this.state.allTickets.forEach(ticket => {\r\n      if (flightId === ticket.flight_id) {\r\n        totalAmountTicket += ticket.amount\r\n      }\r\n    });\r\n    return (<p>{totalAmountTicket}</p>)\r\n  }\r\n\r\n\r\n  render() {\r\n    return (\r\n      <Container>\r\n        <div style={{ marginTop: '2%' }}>\r\n          <Form>\r\n            <Form.Row style={{ marginTop: '4%' }}>\r\n              <Form.Group as={Col} controlId=\"ControlSelectOrigin\" >\r\n                <Form.Label>Identificación\r\n              </Form.Label>\r\n                <IconButton aria-label=\"searchName\" onClick={this._handleChangePassengerFilter}>\r\n                  <FindReplaceIcon />\r\n                </IconButton>\r\n                <Form.Control type='string' placeholder='Identidicación de pasajero' onChange={this._handleChangePassenger.bind(this)}>\r\n\r\n                </Form.Control>\r\n              </Form.Group>\r\n              <Form.Group as={Col} controlId=\"ControlSelectState\" >\r\n                <Form.Label>Estado</Form.Label>\r\n                <Form.Control as=\"select\" defaultValue={'DEFAULT'} onChange={this._handleChangeSelectState.bind(this)}>\r\n                  <option value={'DEFAULT'} disabled hidden>Seleccionar un estado de vuelo</option>\r\n                  <option value={'A tiempo'}>A Tiempo</option>\r\n                  <option value={'Retrasado'}>Retrasado</option>\r\n                  <option value={'Cancelado'}>Cancelado</option>\r\n                </Form.Control>\r\n              </Form.Group>\r\n              <Form.Group as={Col} controlId=\"ControlInputStartDate\">\r\n                <Form.Label>Desde</Form.Label>\r\n                <Form.Control type=\"date\" placeholder=\"dd/mm/yyyy\" onChange={this._handleChangeStartDate.bind(this)} />\r\n              </Form.Group>\r\n              <Form.Group as={Col} controlId=\"ControlInputEndDate\">\r\n                <Form.Label>Hasta</Form.Label>\r\n                <Form.Control type=\"date\" placeholder=\"dd/mm/yyyy\" onChange={this._handleChangeEndDate.bind(this)} />\r\n              </Form.Group>\r\n            </Form.Row>\r\n          </Form>\r\n        </div>\r\n        <div style={{ marginTop: '5%' }}>\r\n          <IconButton aria-label=\"refresh\" onClick={this._onClickRefresTickets}>\r\n            <Refresh />\r\n          </IconButton>\r\n          <Table striped bordered hover responsive >\r\n            <thead>\r\n              <tr>\r\n                <th>Cantidad Operaciones</th>\r\n                <th>Identificador Vuelo</th>\r\n                <th>Nombre</th>\r\n                <th>Origen</th>\r\n                <th>Destino</th>\r\n                <th>Estado</th>\r\n                <th>Código de Aerolinea</th>\r\n                <th>Boletos</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.state.allFlights.map((flight, indexF) => (\r\n                <tr key={indexF}>\r\n                  <td>\r\n                    {this._sumAmountTicket(flight._id)}\r\n                  </td>\r\n                  <td>{flight._id}</td>\r\n                  <td>{flight.name}</td>\r\n                  <td>{flight.origin}</td>\r\n                  <td>{flight.destination}</td>\r\n                  <td>{flight.state}</td>\r\n                  <td>{flight.airline_id}</td>\r\n                  <td>\r\n                    {this.state.allTickets.map((ticket, index) => (\r\n                      flight._id === ticket.flight_id ? (\r\n                        <p key={index}>Código: {ticket._id} | Pasajero: {ticket.passenger[\"firstName\"]} - {ticket.passenger[\"_id\"]}  | Cantidad: {ticket.amount}.</p>\r\n                      ) : null\r\n                    ))}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </Table>\r\n        </div>\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default Report;\r\n"]},"metadata":{},"sourceType":"module"}